<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Import/Export - FinTrack</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/dashboard.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo">
                <h2>üí∞ FinTrack</h2>
            </div>
            <nav class="nav-menu">
                <a href="/dashboard.html" class="nav-item">
                    <span class="icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="/rentals.html" class="nav-item">
                    <span class="icon">üè†</span>
                    <span>Thu√™ ph√≤ng</span>
                </a>
                <a href="/salaries.html" class="nav-item">
                    <span class="icon">üíµ</span>
                    <span>L∆∞∆°ng</span>
                </a>
                <a href="/expenses.html" class="nav-item">
                    <span class="icon">üí≥</span>
                    <span>Chi ti√™u</span>
                </a>
                <a href="/savings.html" class="nav-item">
                    <span class="icon">üè¶</span>
                    <span>Ti·∫øt ki·ªám</span>
                </a>
                <a href="/excel.html" class="nav-item active">
                    <span class="icon">üìÅ</span>
                    <span>Excel Import/Export</span>
                </a>
                <a href="/settings.html" class="nav-item">
                    <span class="icon">‚öôÔ∏è</span>
                    <span>C√†i ƒë·∫∑t</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <h1>Excel Import/Export</h1>
                <div class="user-info">
                    <span id="user-name">User</span>
                    <button class="btn-logout" onclick="logout()">ƒêƒÉng xu·∫•t</button>
                </div>
            </header>

            <div class="content">
                <!-- Import Section -->
                <div class="card">
                    <h2>üì§ Import t·ª´ Excel</h2>
                    <p>T·∫£i l√™n file Excel ch·ª©a d·ªØ li·ªáu t√†i ch√≠nh c·ªßa b·∫°n. File s·∫Ω ƒë∆∞·ª£c ph√¢n t√≠ch v√† import v√†o h·ªá th·ªëng.</p>
                    
                    <div class="upload-area" id="upload-area">
                        <div class="upload-icon">üìÅ</div>
                        <p>K√©o th·∫£ file Excel v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn file</p>
                        <p class="file-types">H·ªó tr·ª£: .xlsx, .xls (t·ªëi ƒëa 10MB)</p>
                        <input type="file" id="file-input" accept=".xlsx,.xls" style="display: none;">
                        <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
                            Ch·ªçn file
                        </button>
                    </div>

                    <div id="selected-file" class="selected-file" style="display: none;">
                        <p><strong>File ƒë√£ ch·ªçn:</strong> <span id="file-name"></span></p>
                        <button class="btn btn-success" onclick="uploadFile()">
                            <span class="icon">‚¨ÜÔ∏è</span> Upload & Import
                        </button>
                        <button class="btn btn-secondary" onclick="clearFile()">H·ªßy</button>
                    </div>

                    <div id="import-status" class="status-message" style="display: none;"></div>
                </div>

                <!-- Export Section -->
                <div class="card">
                    <h2>üì• Export ra Excel</h2>
                    <p>Xu·∫•t t·∫•t c·∫£ d·ªØ li·ªáu t√†i ch√≠nh c·ªßa b·∫°n ra file Excel.</p>
                    
                    <div class="export-options">
                        <div class="form-group">
                            <label>T·ª´ ng√†y:</label>
                            <input type="date" id="export-start-date" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>ƒê·∫øn ng√†y:</label>
                            <input type="date" id="export-end-date" class="form-control">
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="exportData()">
                        <span class="icon">üì•</span> Export to Excel
                    </button>
                </div>

                <!-- Format Guide -->
                <div class="card">
                    <h2>üìã H∆∞·ªõng d·∫´n ƒë·ªãnh d·∫°ng file Excel</h2>
                    <p>File Excel c·∫ßn c√≥ c√°c sheet sau:</p>
                    <ul class="format-guide">
                        <li>
                            <strong>Rental Sheets (Thu√™ ph√≤ng):</strong> Sheet c√≥ t√™n ch·ª©a "P" + s·ªë ph√≤ng (v√≠ d·ª•: P3L1-600.QGV.HCM)
                            <br>Ch·ª©a th√¥ng tin: Ti·ªÅn nh√†, ƒëi·ªán, n∆∞·ªõc, internet, g·ª≠i xe, r√°c, bonus
                        </li>
                        <li>
                            <strong>Salary (L∆∞∆°ng):</strong> Sheet t√™n "salary"
                            <br>Ch·ª©a th√¥ng tin: L∆∞∆°ng c∆° b·∫£n, KPI, d·ª± √°n, OT, th∆∞·ªüng, freelance
                        </li>
                        <li>
                            <strong>Chi-tieu (Chi ti√™u):</strong> Sheet t√™n "chi-tieu"
                            <br>Ch·ª©a th√¥ng tin: Danh m·ª•c, t√™n kho·∫£n chi, s·ªë l∆∞·ª£ng, ƒë∆°n gi√°, ph√¢n b·ªï 6 jars
                        </li>
                        <li>
                            <strong>Ti·∫øt ki·ªám:</strong> Sheet t√™n "Ti·∫øt ki·ªám"
                            <br>Ch·ª©a th√¥ng tin: G·ª≠i m·∫π, g·ª≠i qu·ªπ, s·ªë ti·ªÅn, ng√†y g·ª≠i
                        </li>
                        <li>
                            <strong>Deposit no. (Ti·ªÅn g·ª≠i s·ªë):</strong> Sheet t√™n "deposit no."
                            <br>Ch·ª©a th√¥ng tin: Ng√¢n h√†ng, STK, s·ªë ti·ªÅn g·ªëc, l√£i su·∫•t, k·ª≥ h·∫°n
                        </li>
                        <li>
                            <strong>Setting (C√†i ƒë·∫∑t):</strong> Sheet t√™n "setting"
                            <br>Ch·ª©a th√¥ng tin t√†i kho·∫£n ng√¢n h√†ng
                        </li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/excel.js"></script>
</body>
</html>
