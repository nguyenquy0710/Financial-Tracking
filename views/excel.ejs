<%- include('partials/header', { title: 'Excel Import/Export' , additionalCSS: ['/css/dashboard.css'] }) %>
  <div class="app-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="logo">
        <h2>ğŸ’° FinTrack</h2>
      </div>
      <nav class="nav-menu">
        <a href="/dashboard" class="nav-item">
          <span class="icon">ğŸ“Š</span>
          <span>Dashboard</span>
        </a>
        <a href="/rentals.html" class="nav-item">
          <span class="icon">ğŸ </span>
          <span>ThuÃª phÃ²ng</span>
        </a>
        <a href="/salaries.html" class="nav-item">
          <span class="icon">ğŸ’µ</span>
          <span>LÆ°Æ¡ng</span>
        </a>
        <a href="/expenses.html" class="nav-item">
          <span class="icon">ğŸ’³</span>
          <span>Chi tiÃªu</span>
        </a>
        <a href="/savings.html" class="nav-item">
          <span class="icon">ğŸ¦</span>
          <span>Tiáº¿t kiá»‡m</span>
        </a>
        <a href="/excel.html" class="nav-item active">
          <span class="icon">ğŸ“</span>
          <span>Excel Import/Export</span>
        </a>
        <a href="/settings.html" class="nav-item">
          <span class="icon">âš™ï¸</span>
          <span>CÃ i Ä‘áº·t</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header class="top-bar">
        <h1>Excel Import/Export</h1>
        <div class="user-info">
          <span id="user-name">User</span>
          <button class="btn-logout" onclick="logout()">ÄÄƒng xuáº¥t</button>
        </div>
      </header>

      <div class="content">
        <!-- Import Section -->
        <div class="card">
          <h2>ğŸ“¤ Import tá»« Excel</h2>
          <p>Táº£i lÃªn file Excel chá»©a dá»¯ liá»‡u tÃ i chÃ­nh cá»§a báº¡n. File sáº½ Ä‘Æ°á»£c phÃ¢n tÃ­ch vÃ  import vÃ o há»‡ thá»‘ng.</p>

          <div class="upload-area" id="upload-area">
            <div class="upload-icon">ğŸ“</div>
            <p>KÃ©o tháº£ file Excel vÃ o Ä‘Ã¢y hoáº·c click Ä‘á»ƒ chá»n file</p>
            <p class="file-types">Há»— trá»£: .xlsx, .xls (tá»‘i Ä‘a 10MB)</p>
            <input type="file" id="file-input" accept=".xlsx,.xls" style="display: none;">
            <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
              Chá»n file
            </button>
          </div>

          <div id="selected-file" class="selected-file" style="display: none;">
            <p><strong>File Ä‘Ã£ chá»n:</strong> <span id="file-name"></span></p>
            <button class="btn btn-success" onclick="uploadFile()">
              <span class="icon">â¬†ï¸</span> Upload & Import
            </button>
            <button class="btn btn-secondary" onclick="clearFile()">Há»§y</button>
          </div>

          <div id="import-status" class="status-message" style="display: none;"></div>
        </div>

        <!-- Export Section -->
        <div class="card">
          <h2>ğŸ“¥ Export ra Excel</h2>
          <p>Xuáº¥t táº¥t cáº£ dá»¯ liá»‡u tÃ i chÃ­nh cá»§a báº¡n ra file Excel.</p>

          <div class="export-options">
            <div class="form-group">
              <label>Tá»« ngÃ y:</label>
              <input type="date" id="export-start-date" class="form-control">
            </div>
            <div class="form-group">
              <label>Äáº¿n ngÃ y:</label>
              <input type="date" id="export-end-date" class="form-control">
            </div>
          </div>

          <button class="btn btn-primary" onclick="exportData()">
            <span class="icon">ğŸ“¥</span> Export to Excel
          </button>
        </div>

        <!-- Format Guide -->
        <div class="card">
          <h2>ğŸ“‹ HÆ°á»›ng dáº«n Ä‘á»‹nh dáº¡ng file Excel</h2>
          <p>File Excel cáº§n cÃ³ cÃ¡c sheet sau:</p>
          <ul class="format-guide">
            <li>
              <strong>Rental Sheets (ThuÃª phÃ²ng):</strong> Sheet cÃ³ tÃªn chá»©a "P" + sá»‘ phÃ²ng (vÃ­ dá»¥: P3L1-600.QGV.HCM)
              <br>Chá»©a thÃ´ng tin: Tiá»n nhÃ , Ä‘iá»‡n, nÆ°á»›c, internet, gá»­i xe, rÃ¡c, bonus
            </li>
            <li>
              <strong>Salary (LÆ°Æ¡ng):</strong> Sheet tÃªn "salary"
              <br>Chá»©a thÃ´ng tin: LÆ°Æ¡ng cÆ¡ báº£n, KPI, dá»± Ã¡n, OT, thÆ°á»Ÿng, freelance
            </li>
            <li>
              <strong>Chi-tieu (Chi tiÃªu):</strong> Sheet tÃªn "chi-tieu"
              <br>Chá»©a thÃ´ng tin: Danh má»¥c, tÃªn khoáº£n chi, sá»‘ lÆ°á»£ng, Ä‘Æ¡n giÃ¡, phÃ¢n bá»• 6 jars
            </li>
            <li>
              <strong>Tiáº¿t kiá»‡m:</strong> Sheet tÃªn "Tiáº¿t kiá»‡m"
              <br>Chá»©a thÃ´ng tin: Gá»­i máº¹, gá»­i quá»¹, sá»‘ tiá»n, ngÃ y gá»­i
            </li>
            <li>
              <strong>Deposit no. (Tiá»n gá»­i sá»‘):</strong> Sheet tÃªn "deposit no."
              <br>Chá»©a thÃ´ng tin: NgÃ¢n hÃ ng, STK, sá»‘ tiá»n gá»‘c, lÃ£i suáº¥t, ká»³ háº¡n
            </li>
            <li>
              <strong>Setting (CÃ i Ä‘áº·t):</strong> Sheet tÃªn "setting"
              <br>Chá»©a thÃ´ng tin tÃ i khoáº£n ngÃ¢n hÃ ng
            </li>
          </ul>
        </div>
      </div>
    </main>
  </div>

  <script src="/js/auth.js"></script>
  <script src="/js/excel.js"></script>
  <%- include('partials/footer', { additionalJS: ['/js/auth.js', '/js/excel.js' ] }) %>
