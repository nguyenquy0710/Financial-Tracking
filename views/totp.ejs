<%- include('partials/header', { title: 'TOTP Authenticator' , additionalCSS: ['/css/totp.css'] }) %>

  <div class="app-container">
    <%- include('partials/sidebar', { currentPage: 'totp' }) %>

      <!-- Main Content -->
      <main class="main-content">
        <header class="top-bar totp-header">
          <h1>üîê TOTP Authenticator</h1>
          <div class="header-actions">
            <button id="theme-toggle" class="btn btn-icon" title="Chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi">
              <span class="icon">üåô</span>
            </button>
            <div class="user-info">
              <span id="user-name">User</span>
              <button class="btn-logout">ƒêƒÉng xu·∫•t</button>
            </div>
          </div>
        </header>

        <div class="content">
          <!-- Accounts List - Prioritized Section -->
          <section class="accounts-section card">
            <div class="section-header">
              <h2>Danh S√°ch T√†i Kho·∫£n</h2>
              <button type="button" class="btn btn-primary btn-add-account" id="show-add-form-btn">
                <span class="icon">‚ûï</span> Th√™m T√†i Kho·∫£n
              </button>
            </div>
            <div id="accounts-container">
              <div class="loading">ƒêang t·∫£i...</div>
            </div>
          </section>

          <!-- Add/Edit Account Form - Collapsible -->
          <section class="form-section card" id="form-section" style="display: none;">
            <h2 id="form-title">Th√™m T√†i Kho·∫£n M·ªõi</h2>
            <form id="account-form">
              <input type="hidden" id="account-id" value="">

              <div class="form-group">
                <label for="service-name">T√™n D·ªãch V·ª• *</label>
                <input type="text" id="service-name" class="form-control" placeholder="VD: Google, Facebook, GitHub..." required>
              </div>

              <div class="form-group">
                <label for="username">T√™n Ng∆∞·ªùi D√πng *</label>
                <input type="text" id="username" class="form-control" placeholder="VD: user@example.com" required>
              </div>

              <div class="form-group">
                <label for="secret-key">Secret Key (Kh√≥a B√≠ M·∫≠t) *</label>
                <input type="text" id="secret-key" class="form-control" placeholder="VD: JBSWY3DPEHPK3PXP" required pattern="[A-Z2-7]+"
                  title="Secret key ph·∫£i l√† k√Ω t·ª± A-Z v√† 2-7">
                <small>Secret key th∆∞·ªùng c√≥ ƒë·ªãnh d·∫°ng Base32 (ch·ªâ ch·ª©a A-Z v√† 2-7)</small>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="submit-btn">
                  <span class="icon">‚ûï</span> Th√™m T√†i Kho·∫£n
                </button>
                <button type="button" class="btn btn-secondary" id="cancel-btn" style="display: none;">
                  <span class="icon">‚ùå</span> H·ªßy
                </button>
              </div>
            </form>
          </section>
        </div>
      </main>
  </div>

  <!-- Notification Toast -->
  <div id="notification" class="notification"></div>

  <!-- otplib library for TOTP generation -->

  <%- include('partials/footer', { additionalJS: [ '/js/vendor/buffer.js' , '/js/vendor/otplib.js' ,'/js/totp-indexeddb.js'
    , '/js/totp-lib.js' , '/js/totp.js' ] }) %>
